/******************************* Find all Factors of Large Perfect Square Natural Number in O(sqrt(sqrt(N)) *******************************/

// C++ program to find the factors 
// of large perfect square number 
// in O(sqrt(sqrt(N))) time 

#include "bits/stdc++.h" 
using namespace std; 
  
int MAX = 100000; 
  
// Function that find all the prime 
// factors of N 
void findFactors(int N) 
{ 
    // Store the sqrt(N) in temp 
    int temp = sqrt(N); 
  
    // Initialise factor array with 
    // 1 as a factor in it 
    int factor[MAX] = { 1 }; 
    int i, j, k; 
    int len1 = 1; 
  
    // Check divisibility by 2 
    while (temp % 2 == 0) { 
  
        // Store the factors twice 
        factor[len1++] = 2; 
        factor[len1++] = 2; 
  
        temp /= 2; 
    } 
  
    // Check for other prime 
    // factors other than 2 
    for (j = 3; j < sqrt(temp); j += 2) { 
  
        // If j is a prime factor 
        while (temp % j == 0) { 
  
            // Store the prime 
            // factor twice 
            factor[len1++] = j; 
            factor[len1++] = j; 
            temp /= j; 
        } 
    } 
  
    // If j is prime number left 
    // other than 2 
    if (temp > 2) { 
  
        // Store j twice 
        factor[len1++] = temp; 
        factor[len1++] = temp; 
    } 
  
    // Intialise Matrix M to 
    // to store all the factors 
    int M[len1][MAX] = { 0 }; 
  
    // tpc for rows 
    // tpr for column 
    int tpc = 0, tpr = 0; 
  
    // Initialise M[0][0] = 1 as 
    // it also factor of N 
    M[0][0] = 1; 
    j = 1; 
  
    // Traversing factor array 
    while (j < len1) { 
  
        // If current and previous 
        // factors are not same then 
        // move to next row and 
        // insert the current factor 
        if (factor[j] != factor[j - 1]) { 
            tpr++; 
            M[tpr][0] = factor[j]; 
            j++; 
            tpc = 1; 
        } 
  
        // If current and previous 
        // factors are same then, 
        // Insert the factor with 
        // previous factor inserted 
        // in matrix M 
        else { 
            M[tpr][tpc] 
                = M[tpr][tpc - 1] * factor[j]; 
            j++; 
            tpc++; 
        } 
    } 
  
    // The arr1[] and arr2[] used to 
    // store all the factors of N 
    int arr1[MAX], arr2[MAX]; 
    int l1, l2; 
    l1 = l2 = 1; 
  
    // Initialise arrays as 1 
    arr1[0] = arr2[0] = 1; 
  
    // Traversing the matrix M 
    for (i = 1; i < tpr + 1; i++) { 
  
        // Traversing till column 
        // element doesn't become 0 
        for (j = 0; M[i][j] != 0; j++) { 
  
            // Store the product of 
            // every element of current 
            // row with every element 
            // in arr1[] 
            for (k = 0; k < l1; k++) { 
                arr2[l2++] 
                    = arr1[k] * M[i][j]; 
            } 
        } 
  
        // Copying every element of 
        // arr2[] in arr1[] 
        for (j = l1; j < l2; j++) { 
            arr1[j] = arr2[j]; 
        } 
  
        // length of arr2[] and arr1[] 
        // are equal after copying 
        l1 = l2; 
    } 
  
    // Print all the factors 
    for (i = 0; i < l2; i++) { 
        cout << arr2[i] << ' '; 
    } 
} 
  
// Drivers Code 
int main() 
{ 
    int N = 900; 
    findFactors(N); 
    return 0; 
} 
